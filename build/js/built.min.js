const S=function(t,e){const s=document;return this.isS=!0,this.isNodeList=t=>{var e=Object.prototype.toString.call(t);return"object"==typeof t&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(e)&&"number"==typeof t.length&&(0===t.length||"object"==typeof t[0]&&0<t[0].nodeType)},this.isNode=t=>!(!t||!t.nodeType),this.isDocument=t=>t instanceof Document||t instanceof Window,this.isclass=t=>this.els[0].classList.contains(t),this.defineEls=()=>this.isNode(t)||this.isDocument(t)?[t]:this.isNodeList(t)?t:(e&&e.isS&&(e=e.els[0]),(this.isNode(e)?e:s).querySelectorAll(t)),this.defineEl=()=>this.els[0],this.els=this.defineEls(),this.el=this.defineEl(),this.on=(t,r,n,a)=>{const c=this;let l;return this.bind(t,t=>{var e=c.isNode(r)||c.isNodeList(r)?r:S(r).els,s=a||!1;let i=t.target;for(;i&&i!==this;){if(s)for(l=0;l<S(s).els.length&&i!==S(s).els[l];l++);for(l=0;l<e.length;l++)if(i===e[l]){n(t,i);break}if(!i)break;i=i.parentNode}}),this},this.strToNode=t=>{let e;var s;return e=this.isNode(t)?[t]:((s=this.create("div")).html(t),[s.el.children[0]]),this.els=e,this.el=e[0],this},this.css=function(t,e){if(!e&&""!==e)return this.els[0].style[t];for(var s=0;s<this.els.length;s++)this.els[s].style[t]=e;return this},this.data=(t,e)=>{if(!e&&""!==e)return this.els[0].dataset?this.els[0].dataset[t]:this.els[0].getAttribute(t);for(var s=0;s<this.els.length;s++){if(!this.els[s].dataset)return this.els[s].setAttribute(t,e);this.els[s].dataset[t]=e}return this},this.attr=(e,s)=>s?(this.els.forEach(t=>{t.setAttribute(e,s)}),this):this.el.getAttribute(e),this.create=t=>{t=s.createElement(t);return this.els=[t],this.el=t,this},this.append=t=>{this.el.append(t.el)},this.style=(e,s)=>(this.els.forEach(t=>{t.style[e]=s}),this),this.addclass=t=>{if(t)return Array.isArray(t)||(t=[t]),this.els.forEach(e=>{t.forEach(t=>{e.classList.add(t)})}),this},this.togclass=e=>(this.els.forEach(t=>{t.classList.toggle(e)}),this),this.delclass=t=>(Array.isArray(t)||(t=[t]),this.els.forEach(e=>{t.forEach(t=>{e.classList.remove(t)})}),this),this.remove=t=>{t=t.el;return s.body.contains(t)&&t.parentNode.removeChild(t),this},this.delStor=t=>(localStorage.removeItem(t),this),this.setStor=(t,e)=>(localStorage.setItem(t,e),this),this.getStor=t=>localStorage.getItem(t),this.bind=(e,s)=>{let i;if(e&&s){if("function"==typeof addEventListener)i=(t,e,s)=>{t.addEventListener(e,s,!1)};else{if("function"!=typeof attachEvent)return this;i=(t,e,s)=>{t.attachEvent("on"+e,s)}}this.isNodeList(this.els)||0<this.els.length?this.els.forEach(t=>{i(t,e,s)}):(this.isNode(this.els[0])||this.isDocument(this.els[0]))&&i(this.els[0],e,s)}return this},this.html=e=>""===e||e?(this.els.forEach(t=>{t.innerHTML=e}),this):this.els[0].innerHTML,this.text=e=>""===e||e?(this.els.forEach(t=>{t.innerText=e}),this):this.els[0].innerText,this.val=e=>""===e||e?(this.els.forEach(t=>{t.value=e}),this):this.els[0].value,this instanceof S?this.S:new S(t,e)},heightMenu=(!function(I,j){new function(){const t=I(".select_store_button");var e=I(".instock_stores__cities"),s=I(".instock_stores__stores_list");const i=I("ul",e),r=I("ul",s),n=I(".overlay"),a=I("#select_store"),c=I("#close_store"),l=I(".instock"),o=I(".instock_stores__stores_list .search__input input");I(".city_title");this.ObjectManager,this.searchString="",this.fromProduct=!1,this.isSelectCity=!0,this.store_id=localStorage.getItem("current_store")||1,this.city_id=localStorage.getItem("current_city")||1,this.currentMap="map";const d=()=>j.reduce((t,e)=>{const{id:s,title:i}=e;return(t=t||[]).filter(t=>t.id==s).length?t:[...t,{id:s,title:i}]},[]),u=()=>this.searchString?j.filter(t=>-1!==t.store_title.toLowerCase().indexOf(this.searchString.toLowerCase())&&t.id==this.city_id):j.filter(t=>t.id==this.city_id),h=()=>{n.css("display","grid"),_()},p=()=>{n.css("display","none"),i.html(" "),r.html(" "),this.currentMap="map_product"},_=()=>{d().forEach(t=>{var{id:t,title:e}=t,t=I().strToNode(`<li data-id="${t}">${e}</li>`);t.bind("click",b),i.append(t)}),f()},f=t=>{var t=t||"map",e="map"==t?0:1,s=I(".instock_stores__stores_list").els[e];const i=I("ul",I(s));i.html(" "),this.isSelectCity=1!=e,this.currentMap=t;s=u();s.forEach(t=>{var{rsa_id:t,store_title:e}=t,e=e.split(",")[1]+", "+e.split(",")[2],t=I().strToNode(`<li data-id="${t}"${t==this.store_id?' class="active"':""}>${this.isSelectCity?"":"<span>26 шт.</span>"}${e}</li>`);t.bind("click",m),i.append(t)}),0<s.length&&(I("#"+t).html(" "),v(t))},m=t=>{t=t.currentTarget;this.store_id=t.dataset.id,k(t.dataset.id),I(".instock_stores__stores_list ul li").delclass("active"),I(t).addclass("active")},b=t=>{this.city_id=t.currentTarget.dataset.id,f()},g=t=>{this.store_id=t.dataset.id,S()},S=()=>{var t=j.filter(t=>t.rsa_id==this.store_id),e=t[0].store_title.split(",");I(".select_store_button .text").text(e[1]+", "+e[2]),I(".select_store_button").addclass("selected"),I(".city_title").text(t[0].title),localStorage.setItem("current_store",this.store_id),localStorage.setItem("current_city",this.city_id),p()},v=t=>{var e=u(),s=parseFloat(e[0].coordinates.split(",")[0]),i=parseFloat(e[0].coordinates.split(",")[1]),t=new ymaps.Map(t,{center:[s,i],zoom:3<e.length?12:14},{suppressMapOpenBlock:!0});this.objectManager=new ymaps.ObjectManager({clusterize:!0,gridSize:32,clusterDisableClickZoom:!0}),this.objectManager.objects.options.set("preset","islands#greenDotIcon"),this.objectManager.clusters.options.set("preset","islands#greenClusterIcons"),0<e.length&&e.forEach(t=>{var e=parseFloat(t.coordinates.split(",")[0]),s=parseFloat(t.coordinates.split(",")[1]);this.objectManager.add({type:"Feature",id:t.rsa_id,geometry:{type:"Point",coordinates:[e,s]},properties:{hintContent:t.store_title,balloonContent:`<p>${t.store_title}</p><button class="button primary select_from_map" data-id="${t.rsa_id}">Выбрать</button>`},options:{iconLayout:"default#image",iconImageHref:"assets/icons/inactive_point.png",iconImageSize:[14,14],iconImageOffset:[-7,-7]}})}),this.objectManager.objects.events.add("click",function(t){k(t.get("objectId"))}),t.geoObjects.add(this.objectManager)},y=()=>{this.objectManager.objects.getAll().forEach(t=>{this.objectManager.objects.setObjectOptions(t.id,{iconImageHref:"assets/icons/inactive_point.png",iconImageSize:[14,14],iconImageOffset:[-7,-7]})})},k=t=>{var e=this.objectManager.getObjectState(t);e.isClustered?(this.objectManager.clusters.state.set("activeObject",this.objectManager.objects.getById(t)),this.objectManager.clusters.balloon.open(e.cluster.id)):this.objectManager.objects.balloon.open(t),y(),this.objectManager.objects.setObjectOptions(t,{iconImageHref:"assets/icons/active_point.png",iconImageSize:[24,24],iconImageOffset:[-12,-12]})},M=()=>{this.isSelectCity=!1,this.currentMap="map",I(".instock_stores").addclass("product_instock"),h()},x=()=>{this.isSelectCity=!0,this.currentMap="map",I(".instock_stores").delclass("product_instock"),h()},E=t=>{t=t.currentTarget;this.searchString=t.value,console.log("this.currentMap = ",this.currentMap),f(this.currentMap)};ymaps.ready(function(){l.bind("click",M),t.bind("click",x),n.bind("click",p),a.bind("click",S),c.bind("click",p),I("#map").on("click",".select_from_map",(t,e)=>{g(e)}),I("#map_product").on("click",".select_from_map",(t,e)=>{g(e)}),I(".instock_stores").bind("click",t=>{t.stopPropagation()}),o.bind("input",E),I("#map_product").el&&(this.isSelectCity=!1,this.currentMap="map_product",f("map_product"))})}}(S,Stores),!function(e){{const t={},s=e(".header_menu_panel__burger"),i=e(".burger",s),r=e("ul",s),n=e("ul > li",r),a=e(".header_menu_panel__list > li"),c=e(".header_menu_panel__list .sub_menu"),l=s=>{if(!s)return c;let i=0;return a.els.forEach((t,e)=>{t===s&&(i=e)}),e(c.els[i])},o=()=>{a.delclass("active"),i.delclass("active"),l().delclass("forburger"),l().css("display",""),r.css("display",""),clearTimeout(t.timerDisableBurgerMenu)},d=()=>{clearTimeout(t.timerDisableBurgerMenu),t.timerDisableBurgerMenu=setTimeout(o,500)};r.bind("mouseleave",()=>{d()}),c.bind("mouseleave",()=>{d()}),n.bind("click",t=>{if(r.css("display")){const i=t.currentTarget;let s=0;n.els.forEach((t,e)=>{t===i&&(s=e)}),n.delclass("active"),l().delclass("forburger"),e(i).addclass("active"),e(l().els[s]).addclass("forburger")}}),r.bind("mouseenter",()=>{clearTimeout(t.timerDisableBurgerMenu)}),c.bind("mouseenter",()=>{clearTimeout(t.timerDisableBurgerMenu)}),s.bind("click",t=>{t.currentTarget,t=r.css("display"),n.delclass("active"),t?o():(a.delclass("active"),r.css("display","block"),i.addclass("active"),l().css("display",""),e(l().els[0]).addclass("forburger"),e(n.els[0]).addclass("active"))}),a.bind("click",t=>{t=t.currentTarget,o(),e(t).addclass("active"),l(t).css("display","block")}),c.bind("click",t=>{t.stopPropagation()}),r.bind("click",t=>{t.stopPropagation()})}}(S),!function(j,T){function e(t){const e=j(t),s=625,i={interval:e.data("interval")},r=i.interval||1e4,n=j("ul",e),a=(n.html(n.html()+n.html()),j("ul > li",e)),c=a.els.length,l=c/2;let o=0;j(".banner_navigation_all_page",e).text(l),n.css("top",o+"px");const d=j(".but_next_prev.prev",e),u=j(".but_next_prev.next",e);let h,p=0,_=null,f=0;function m(n,a,c){n.timer&&clearInterval(n.timer),n.timer=setInterval(function(){let t=!0,e=parseInt((i=n.el,r=a,(i.currentStyle||getComputedStyle(i,null))[r])),s=(c-e)/8;var i,r;s=0<s?Math.ceil(s):Math.floor(s),e!==c&&(t=!1,n.css(a,e+s+"px")),t&&(clearInterval(n.timer),n.timer=null)},30)}const b=function(){0<f?f--:(f=Math.round(l-1),n.css("left",-(p*l)+"px")),y()},g=function(){f<c-1?f++:(f=l,n.css("left",-(p*(l-1))+"px")),y()},S=function(){clearInterval(_)},v=function(){_=setInterval(function(){g()},r)},y=function(){m(n,"left",-p*f),j(".banner_navigation_cur_page").text(Math.round(f%l)+1)},k=function(){var t=Math.round(e.el.offsetWidth);n.css("width",t*c+"px"),a.css("width",t+"px"),h=t,p=Math.round(h),_=setInterval(function(){g()},r)};var M,x,E;const I=function(){var t;850<j(".wrapper").el.offsetWidth||(t=e.el.offsetWidth<s?25:45,t=j(".wrapper").el.offsetWidth/3.16+t,e.css("height",t+o+"px"))};I(),j(T).bind("load",function(){!function(){const t=this;let e=this,s,i,r=null,n=0;function a(){n=+new Date,r=null,i=c.apply(e,s),r||(e=s=null)}const c=k()}()}),d.bind("click",function(){b()}),u.bind("click",function(){g()}),e.bind("mouseover",function(){S()}),e.bind("mouseout",function(){v()}),j(T).bind("resize",function(){clearInterval(_),_=null,I(),k()}),M=0,E=x=null,e.bind("touchend",function(){E&&(40<Math.abs(E)?(0<E?g:b)():n.css("left",parseInt(n.css("left").replace("px",""))+E+"px")),x=E=null,M=0,v()}),e.bind("touchstart",function(t){M=t.touches[0].pageX,S()}),e.bind("touchmove",function(t){var t=t.touches[0].pageX,e=(x=x||M)-t;E=0==e?null:M-t,n.css("left",parseInt(n.css("left").replace("px",""))-e+"px"),x=t})}j(".banner").els.forEach(t=>{e(t)})}(S,(document,window)),!function(b){function e(t){const e=b(t),r=b("ul",e);var t=b("li",r),s=b(".wrapper").el.offsetWidth;const n=t.els.length*(t.el.offsetWidth+5),a=n-s,c=(r.el.style.width=n+"px",b(".but_next_prev.prev",e)),l=b(".but_next_prev.next",e),o=b(".progress_bar__line",e).el.offsetWidth,d=b(".progress_bar__line_slider",e),u=d.el.offsetWidth,i=t.el.offsetWidth,h=t=>{m();let e=+r.el.style.left.replace(/[^0-9-]+/g,"")+i;0<e&&(e=0),f(e)},p=t=>{m();let e=+r.el.style.left.replace(/[^0-9-]+/g,"")-i;e<-a&&(e=-a),f(e)};let _;const f=i=>{var t,e;t="disabled",(e=i)==-a?l.addclass(t):l.delclass(t),0==e?c.addclass(t):c.delclass(t),e=i,d.el.style.left=-e*(o-u)/(n-document.documentElement.clientWidth)+"px",_=setInterval(function(){var t=+r.el.style.left.replace(/[^0-9-]+/g,"");let e=!0;var s=0<(s=(i-t)/8)?Math.ceil(s):Math.floor(s);t!==i&&(e=!1,r.el.style.left=t+s+"px"),e&&m()},30)},m=()=>{clearInterval(_),_=null};{let s=0,i=null,r=null;e.bind("touchend",t=>{r&&40<Math.abs(r)&&(0<r?p:h)(t),r=null,i=null,s=0}),e.bind("touchstart",t=>{s=t.touches[0].pageX}),e.bind("touchmove",t=>{var t=t.touches[0].pageX,e=(i=i||s)-t;r=0==e?null:s-t,i=t})}c.bind("click",t=>{h(t)}),l.bind("click",t=>{p(t)})}b(".offers").els.forEach(t=>{e(t)})}(S),S(".header_top_panel").el.offsetHeight+S(".header_search_panel").el.offsetHeight),panel=S(".header_menu_panel"),submenus=S(".sub_menu"),butInCart=S(".incart"),countPricesCart=(S(document).bind("scroll",()=>{var t=window.scrollY,e=(t>heightMenu?(panel.addclass("sticked"),submenus.addclass("forstick")):(panel.delclass("sticked"),submenus.delclass("forstick")),S(".product_info>div:nth-child(2)").el);e&&(e.getBoundingClientRect().top,S(".offers").el.getBoundingClientRect().y,t<1200)&&(e.style.top=t+"px")}),butInCart.bind("click",t=>{let e,s;var i;s=S(t.target.parentElement).isclass("incart")?(e=S(t.target.parentElement.parentElement),t.target.parentElement):(e=S(t.currentTarget.parentElement),t.currentTarget),e.isclass("cart")||(i=(t=S("div",s)).text(),e.addclass("cart"),t.html(`<span class="minus">-</span><span class="qty">${i}</span><span class="plus">+</span>`))}),S(document).on("click",".plus",(t,e)=>{var e=S(".qty",e.parentElement),s=+e.text()+1;e.text(s)}),S(document).on("click",".minus",(t,e)=>{var e=e.parentElement,s=S(".qty",e),i=+s.text()-1;i<1?(S(e).html(1),S(e.parentElement.parentElement).delclass("cart")):s.text(i)}),S("header .cart").bind("click",()=>{countPricesCart(),S(".cart_popup").togclass("open")}),S(".delete_popup_cart").bind("click",t=>{var t=t.currentTarget,e=+S(".actions_button.cart").text()-1;let s=`<span>${e}</span>`;t=S(t.parentElement.parentElement);S().remove(t),countPricesCart(),0==e&&(s="",S(".cart_popup").togclass("open")),S(".actions_button.cart").html(s),S(".cart_popup__sum_head span").text(e)}),()=>{const e={current:0,old:0};S(".cart_popup__product_price > div").els.forEach(t=>{t=S(t).text().replace(" ₽"," ").replace(" ₽","").split(" ");e.current+=parseFloat(t[0]),e.old+=parseFloat(t[1])}),S(".cart_popup__sum_price").text(e.current+" ₽"),S(".cart_popup__sum_old_price").text(e.old+" ₽")});let timerCloseSearch;const startTimerCloseSearch=()=>{clearTimeout(timerCloseSearch),timerCloseSearch=setTimeout(closeSearch,500)},closeSearch=()=>{S(".header_menu_panel__actions .search__input input").val()||(S(".actions_button.search").css("visibility","visible"),S(".header_menu_panel__actions .search__input").delclass("active"))},current_store=(S(".header_menu_panel .actions_button.search").bind("click",t=>{S(t.currentTarget).css("visibility","hidden"),S(".header_menu_panel__actions .search__input").addclass("active")}),S(".header_menu_panel__actions .search__input").bind("mouseleave",()=>{startTimerCloseSearch()}),S(".header_search_panel .actions_button.search").bind("click",t=>{var e=S(".header_search_panel .search__input");e.isclass("active")?(S(".header_menu_panel").css("marginTop","0.55em"),e.delclass("active")):(S(".header_menu_panel").css("marginTop","4em"),e.addclass("active"))}),localStorage.getItem("current_store"));if(current_store){const a2=Stores.filter(t=>t.rsa_id==current_store),b2=a2[0].store_title.split(",");S(".select_store_button .text").text(b2[1]+", "+b2[2]),S(".select_store_button").addclass("selected")}const current_city=localStorage.getItem("current_city");if(current_city){const d2=Stores.filter(t=>t.id==current_city);S(".city_title").text(d2[0].title)}S(".dropdown_sort").bind("click",t=>{t=t.currentTarget;S(t).togclass("open")}),S(".open_map").bind("click",t=>{var t=S(t.currentTarget),e=S("#map_product"),e=(e.togclass("open"),e.isclass("open")),s=S(".instock_stores.forproduct>.instock_stores__stores .instock_stores__stores_list ul");S(".instock_stores.forproduct>.instock_stores__stores .instock_stores__stores_list .search__input").css("display",e?"none":"block"),S(".instock_stores.forproduct>.instock_stores__stores .instock_stores__stores_list .filter_sort").css("display",e?"none":"block"),t.text(e?"Список":"На карте"),s.css("display",e?"none":"block")}),S(".filter_button").bind("click",()=>{S("aside").togclass("open")});